---
import type { CollectionEntry } from 'astro:content';

interface Props {
	entry: CollectionEntry<'posts'>;
	category?: string;
}

const { entry, category } = Astro.props as Props;
const idPath = entry.id.replace(/\\/g, '/');
const catFromId = (entry.id || '').split('/')[0] || category || '';
const basename = idPath.split('/').pop();
const href = `/post/${basename}`;
---

<article
	class="list-item"
	data-tags={entry.data.tags?.join(',') ?? ''}
	data-type="post"
	data-category={category ?? catFromId}
>
	<div>
		<p class="eyebrow">{entry.data.created}</p>
		<h3 class="list-item__title">
			<a href={href}>{entry.data.title}</a>
		</h3>
		{entry.data.summary && <p class="list-item__summary">{entry.data.summary}</p>}
	</div>
	{entry.data.tags && (
		<div class="chips">
			{entry.data.tags.slice(0, 4).map((tag) => (
				<span class="chip">{tag}</span>
			))}
		</div>
	)}
</article>

